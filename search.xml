<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>pip 与 ansible 的安装与配置</title>
      <link href="/2020/01/03/pip-%E4%B8%8E-ansible/"/>
      <url>/2020/01/03/pip-%E4%B8%8E-ansible/</url>
      
        <content type="html"><![CDATA[<h2 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h2><h3 id="下载安装-https-pip-pypa-io-en-stable-installing"><a href="#下载安装-https-pip-pypa-io-en-stable-installing" class="headerlink" title="下载安装(https://pip.pypa.io/en/stable/installing/)"></a>下载安装(<a href="https://pip.pypa.io/en/stable/installing/" target="_blank" rel="noopener">https://pip.pypa.io/en/stable/installing/</a>)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;bootstrap.pypa.io&#x2F;get-pip.py --no-check-certificate</span><br><span class="line">python27 get-pip.py</span><br></pre></td></tr></table></figure><p>ps: python27是编译安装的python 2.7</p><h3 id="做软链接"><a href="#做软链接" class="headerlink" title="做软链接"></a>做软链接</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s &#x2F;usr&#x2F;local&#x2F;python27&#x2F;bin&#x2F;pip &#x2F;usr&#x2F;bin&#x2F;pip</span><br></pre></td></tr></table></figure><h3 id="仓库修改为国内镜像源"><a href="#仓库修改为国内镜像源" class="headerlink" title="仓库修改为国内镜像源"></a>仓库修改为国内镜像源</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim ~&#x2F;.pip&#x2F;pip.conf</span><br><span class="line">[global]</span><br><span class="line">trusted-host&#x3D; mirrors.aliyun.com</span><br><span class="line">index-url &#x3D; https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple</span><br></pre></td></tr></table></figure><h2 id="ansible"><a href="#ansible" class="headerlink" title="ansible"></a>ansible</h2><h3 id="安装sshpass-epel仓库才有"><a href="#安装sshpass-epel仓库才有" class="headerlink" title="安装sshpass(epel仓库才有)"></a>安装sshpass(epel仓库才有)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y sshpass</span><br></pre></td></tr></table></figure><h3 id="安装ansible"><a href="#安装ansible" class="headerlink" title="安装ansible"></a>安装ansible</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install ansible</span><br></pre></td></tr></table></figure><h3 id="添加软连接"><a href="#添加软连接" class="headerlink" title="添加软连接"></a>添加软连接</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s &#x2F;usr&#x2F;local&#x2F;python27&#x2F;bin&#x2F;ansible* &#x2F;usr&#x2F;bin</span><br></pre></td></tr></table></figure><h2 id="ansible常用模块"><a href="#ansible常用模块" class="headerlink" title="ansible常用模块"></a>ansible常用模块</h2><h3 id="远程命令模块"><a href="#远程命令模块" class="headerlink" title="远程命令模块"></a>远程命令模块</h3><p>功能：</p><ul><li>模块包括command，script，shell，都可以实现远程shell命令运行。</li><li>command为ansible默认模块，可以远程执行命令。</li><li>shell功能是执行远程主机的较复杂的shell命令（脚本？）</li><li>script功能是在远程主机执行主控端存放的shell脚本</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ansible webservers -m command -a &quot;free -m&quot;</span><br><span class="line">ansible webservers -m shell -a &quot;&#x2F;home&#x2F;test.sh&quot;</span><br><span class="line">ansible webservers -m shell -a &quot;home&#x2F;test.sh 12 34&quot;</span><br></pre></td></tr></table></figure><h3 id="copy模块"><a href="#copy模块" class="headerlink" title="copy模块"></a>copy模块</h3><p>功能：</p><ul><li>实现主控端向目标主机拷贝文件，类似scp的功能</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m copy -a &quot;src&#x3D;&#x2F;home&#x2F;test.sh dest&#x3D;&#x2F;tmp&#x2F; owner&#x3D;root group&#x3D;root mode&#x3D;0755&quot;</span><br></pre></td></tr></table></figure><h3 id="stat模块"><a href="#stat模块" class="headerlink" title="stat模块"></a>stat模块</h3><p>功能：</p><ul><li>获取远程文件状态信息，包括atime,ctime,mtime,md5,uid,gid等信息</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible webservers -m stat -a &quot;path&#x3D;&#x2F;etc&#x2F;sysctl.conf&quot;</span><br></pre></td></tr></table></figure><h3 id="yum，apt模块"><a href="#yum，apt模块" class="headerlink" title="yum，apt模块"></a>yum，apt模块</h3><p>功能：</p><ul><li>Linux平台软件包管理操作</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ansible webservers -m apt -a &quot;pkg&#x3D;zsh state&#x3D;latest&quot;</span><br><span class="line">ansible webservers -m yum -a &quot;name&#x3D;zsh state&#x3D;latest&quot;</span><br><span class="line">ansible webservers -m yum -a &quot;name&#x3D;xxx.rpm state&#x3D;present&quot;</span><br><span class="line">ansible webservers -m yum -a &quot;name&#x3D;&#39;@Development Tools&#39; state&#x3D;present&quot;</span><br></pre></td></tr></table></figure><p>注意：如果目标主机Python版本发生变化需要在hosts文件中指定</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[webservers:vars]</span><br><span class="line">ansible_python_interpreter&#x3D;&quot;&#x2F;usr&#x2F;bin&#x2F;python_old&quot;</span><br></pre></td></tr></table></figure><h3 id="cron模块"><a href="#cron模块" class="headerlink" title="cron模块"></a>cron模块</h3><p>功能：</p><ul><li>远程主机crontab配置</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible webservers -m cron -a &quot;name&#x3D;&#39;do something&#39; hour&#x3D;5,2 job&#x3D;&#39;ls -alh &gt; &#x2F;dev&#x2F;null&#39;&quot;</span><br></pre></td></tr></table></figure><h3 id="mount模块"><a href="#mount模块" class="headerlink" title="mount模块"></a>mount模块</h3><p>功能：</p><ul><li>远程主机分区挂载</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible webservers -m mount -a &quot;name&#x3D;&#x2F;mnt&#x2F;data src&#x3D;&#x2F;dev&#x2F;sd0 fstype&#x3D;ext4 opts&#x3D;ro state&#x3D;present&quot;</span><br></pre></td></tr></table></figure><h3 id="service模块"><a href="#service模块" class="headerlink" title="service模块"></a>service模块</h3><p>功能：</p><ul><li>远程主机系统服务管理</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ansible webservers -m service -a &quot;name&#x3D;httpd state&#x3D;stopped&quot;</span><br><span class="line">ansible webservers -m service -a &quot;name&#x3D;httpd state&#x3D;restarted&quot;</span><br><span class="line">ansible webservers -m service -a &quot;name&#x3D;httpd state&#x3D;reloaded&quot;</span><br></pre></td></tr></table></figure><h3 id="user模块"><a href="#user模块" class="headerlink" title="user模块"></a>user模块</h3><p>功能：</p><ul><li>远程主机系统用户管理</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ansible webservers -m user -a &quot;name&#x3D;alice comment&#x3D;&#39;i am alice&#39;&quot;</span><br><span class="line">ansible webservers -m user -a &quot;name&#x3D;bob state&#x3D;absent remove&#x3D;yes&quot;</span><br></pre></td></tr></table></figure><h3 id="get-url模块"><a href="#get-url模块" class="headerlink" title="get_url模块"></a>get_url模块</h3><p>功能：</p><ul><li>实现远程主机下载执行URL到本地，支持sha256sum文件校检</li></ul><p>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible webserver -m get_url -a &quot;url&#x3D;http:&#x2F;&#x2F;images.17173.com&#x2F;2016&#x2F;acg&#x2F;2016&#x2F;01&#x2F;07&#x2F;gq0107tt10.jpg dest&#x3D;&#x2F;root&#x2F; mode&#x3D;0775 force&#x3D;yes&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ansible </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LNMP 编译安装</title>
      <link href="/2019/12/31/LNMP%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/"/>
      <url>/2019/12/31/LNMP%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h2 id="安装准备"><a href="#安装准备" class="headerlink" title="安装准备"></a>安装准备</h2><h3 id="先卸载之前yum安装的相关软件"><a href="#先卸载之前yum安装的相关软件" class="headerlink" title="先卸载之前yum安装的相关软件"></a>先卸载之前yum安装的相关软件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#停止mysql服务</span><br><span class="line">&#x2F;etc&#x2F;init.d&#x2F;mysqld stop</span><br><span class="line">#停止php-fpm服务</span><br><span class="line">&#x2F;etc&#x2F;init.d&#x2F;php-fpm stop</span><br><span class="line">#删除相关rpm包</span><br><span class="line">yum remove php* mysql*</span><br><span class="line">#删除相关配置文件</span><br><span class="line">rm -rf &#x2F;var&#x2F;lib&#x2F;mysql  &#x2F;etc&#x2F;my.cnf</span><br></pre></td></tr></table></figure><h3 id="安装编译工具和相关依赖"><a href="#安装编译工具和相关依赖" class="headerlink" title="安装编译工具和相关依赖"></a>安装编译工具和相关依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ autoconf libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5 krb5-devel libidn libidn-devel openssl openssl-devel openldap openldap-devel openldap-clients openldap-servers libXpm* pcre-devel gd-devel net-snmp-devel</span><br></pre></td></tr></table></figure><h3 id="下载依赖安装包"><a href="#下载依赖安装包" class="headerlink" title="下载依赖安装包"></a>下载依赖安装包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mkdir &#x2F;tmp&#x2F;source</span><br><span class="line">cd &#x2F;tmp&#x2F;source</span><br><span class="line">wget http:&#x2F;&#x2F;nginx.org&#x2F;download&#x2F;nginx-1.10.1.tar.gz</span><br><span class="line">wget http:&#x2F;&#x2F;cn2.php.net&#x2F;distributions&#x2F;php-5.4.35.tar.bz2#php5.4</span><br><span class="line">wget http:&#x2F;&#x2F;dev.mysql.com&#x2F;get&#x2F;Downloads&#x2F;MySQL-5.6&#x2F;mysql-5.6.22.tar.gz</span><br><span class="line">wget https:&#x2F;&#x2F;ftp.gnu.org&#x2F;gnu&#x2F;libiconv&#x2F;libiconv-1.14.tar.gz</span><br><span class="line">wget http:&#x2F;&#x2F;downloads.sourceforge.net&#x2F;project&#x2F;mcrypt&#x2F;Libmcrypt&#x2F;2.5.8&#x2F;libmcrypt-2.5.8.tar.gz?r&#x3D;http%3A%2F%2Fsourceforge.net%2Fprojects%2Fmcrypt%2Ffiles%2FLibmcrypt%2F2.5.8%2F&amp;ts&#x3D;1418528625&amp;use_mirror&#x3D;tcpdiag</span><br><span class="line">wget http:&#x2F;&#x2F;downloads.sourceforge.net&#x2F;project&#x2F;mhash&#x2F;mhash&#x2F;0.9.9.9&#x2F;mhash-0.9.9.9.tar.gz?r&#x3D;http%3A%2F%2Fsourceforge.net%2Fprojects%2Fmhash%2Ffiles%2Fmhash%2F0.9.9.9%2F&amp;ts&#x3D;1418530194&amp;use_mirror&#x3D;hivelocity</span><br><span class="line">wget http:&#x2F;&#x2F;downloads.sourceforge.net&#x2F;project&#x2F;mcrypt&#x2F;MCrypt&#x2F;2.6.8&#x2F;mcrypt-2.6.8.tar.gz?r&#x3D;http%3A%2F%2Fsourceforge.net%2Fprojects%2Fmcrypt%2Ffiles%2FMCrypt%2F2.6.8%2F&amp;ts&#x3D;1418531968&amp;use_mirror&#x3D;softlayer-dal</span><br><span class="line">wget http:&#x2F;&#x2F;zlib.net&#x2F;zlib-1.2.8.tar.gz</span><br></pre></td></tr></table></figure><h3 id="安装libiconv-libmcrypt-mhash-bision"><a href="#安装libiconv-libmcrypt-mhash-bision" class="headerlink" title="安装libiconv,libmcrypt,mhash,bision"></a>安装libiconv,libmcrypt,mhash,bision</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf libmcrypt-2.5.8.tar.gz</span><br><span class="line">cd libmcrypt-2.5.8</span><br><span class="line">.&#x2F;configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">tar zxvf libiconv-1.14.tar.gz</span><br><span class="line">cd libiconv-1.14</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;iconv     #指定iconv安装目录</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">tar zxvf mhash-0.9.9.9.tar.gz</span><br><span class="line">cd mhash-0.9.9.9</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h2 id="编译安装mysql"><a href="#编译安装mysql" class="headerlink" title="编译安装mysql"></a>编译安装mysql</h2><h3 id="安装cmake"><a href="#安装cmake" class="headerlink" title="安装cmake"></a>安装cmake</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;cmake.org&#x2F;files&#x2F;v3.6&#x2F;cmake-3.6.1.tar.gz</span><br><span class="line">tar zxvf cmake-3.6.1.tar.gz</span><br><span class="line">cd cmake-2.8.3&#x2F;</span><br><span class="line">.&#x2F;configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="准备mysql-amp-nginx用户-数据目录"><a href="#准备mysql-amp-nginx用户-数据目录" class="headerlink" title="准备mysql&amp;nginx用户,数据目录"></a>准备mysql&amp;nginx用户,数据目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">useradd -r mysql  </span><br><span class="line">useradd -r nginx</span><br><span class="line">mkdir -p &#x2F;data&#x2F;mysql</span><br><span class="line">chown -R mysql.mysql &#x2F;data&#x2F;mysql</span><br><span class="line">mkdir -p &#x2F;data&#x2F;www</span><br><span class="line">chown -R nginx.nginx &#x2F;data&#x2F;www</span><br></pre></td></tr></table></figure><h3 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf mysql-5.6.13.tar.gz</span><br><span class="line">cd mysql-5.6.13</span><br><span class="line">cmake -DCMAKE_INSTALL_PREFIX&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql -DMYSQL_UNIX_ADDR&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;mysql.sock -DDEFAULT_CHARSET&#x3D;utf8 -DDEFAULT_COLLATION&#x3D;utf8_general_ci -DWITH_INNOBASE_STORAGE_ENGINE&#x3D;1 -DWITH_ARCHIVE_STORAGE_ENGINE&#x3D;1 -DWITH_BLACKHOLE_STORAGE_ENGINE&#x3D;1 -DMYSQL_DATADIR&#x3D;&#x2F;data&#x2F;mysql -DENABLE_DOWNLOADS&#x3D;1</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><blockquote><p>mysql编译选项说明： </p></blockquote><table><thead><tr><th>选项</th><th>功能</th></tr></thead><tbody><tr><td>-DCMAKE_INSTALL_PREFIX=dir_name</td><td>设置mysql安装目录</td></tr><tr><td>-DMYSQL_UNIX_ADDR=file_name</td><td>设置监听套接字路径，这必须是一个绝对路径名。默认为/tmp/mysql.sock</td></tr><tr><td>-DDEFAULT_CHARSET=charset_name</td><td>设置服务器的字符集。<br>缺省情况下，MySQL使用latin1的（CP1252西欧）字符集。cmake/character_sets.cmake文件包含允许的字符集名称列表。</td></tr><tr><td>-DDEFAULT_COLLATION=collation_name</td><td>设置服务器的排序规则。</td></tr><tr><td>-DWITH_INNOBASE_STORAGE_ENGINE=1 <br>  -DWITH_ARCHIVE_STORAGE_ENGINE=1 <br>-DWITH_BLACKHOLE_STORAGE_ENGINE=1  <br>-DWITH_PERFSCHEMA_STORAGE_ENGINE=1</td><td>存储引擎选项：<br>MyISAM，MERGE，MEMORY，和CSV引擎是默认编译到服务器中，并不需要明确地安装。静态编译一个存储引擎到服务器，使用-DWITH_engine_STORAGE_ENGINE= 1<br>可用的存储引擎值有：ARCHIVE, BLACKHOLE, EXAMPLE, FEDERATED, INNOBASE (InnoDB), PARTITION (partitioning support), 和PERFSCHEMA (Performance Schema)</td></tr><tr><td>-DMYSQL_DATADIR=dir_name</td><td>设置mysql数据库文件目录</td></tr><tr><td>-DMYSQL_TCP_PORT=port_num</td><td>设置mysql服务器监听端口，默认为3306</td></tr><tr><td>-DENABLE_DOWNLOADS=bool</td><td>是否要下载可选的文件。例如，启用此选项（设置为1），cmake将下载谷歌所使用的测试套件运行单元测试。</td></tr></tbody></table><blockquote><p>如果cmake过程出错，需要重新cmake需要删除CMakeCache.txt </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm CMakeCache.txt</span><br></pre></td></tr></table></figure><h3 id="初始化mysql"><a href="#初始化mysql" class="headerlink" title="初始化mysql"></a>初始化mysql</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#basedir为mysql安装目录,datadir为数据库的数据文件存放目录</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;scripts&#x2F;mysql_install_db --basedir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql --datadir&#x3D;&#x2F;data&#x2F;mysql&#x2F; --user&#x3D;mysql</span><br></pre></td></tr></table></figure><h3 id="添加mysql服务到init脚本"><a href="#添加mysql服务到init脚本" class="headerlink" title="添加mysql服务到init脚本"></a>添加mysql服务到init脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;local&#x2F;mysql</span><br><span class="line">cp support-files&#x2F;mysql.server &#x2F;etc&#x2F;init.d&#x2F;mysqld #拷贝服务控制脚本文件(确保拷贝过去的脚本有x权限)</span><br><span class="line">#vim &#x2F;etc&#x2F;profile 将mysql库文件路径和bin路径假如PATH环境变量</span><br><span class="line">export PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin:&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;lib:$PATH</span><br><span class="line">#应用配置文件</span><br><span class="line">source &#x2F;etc&#x2F;profile</span><br><span class="line">#mysql用户对安装目录有权限</span><br><span class="line">chown -R mysql.mysql &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;</span><br></pre></td></tr></table></figure><h3 id="修改mysql的root用户密码"><a href="#修改mysql的root用户密码" class="headerlink" title="修改mysql的root用户密码"></a>修改mysql的root用户密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -u root password &#39;redhat&#39;</span><br></pre></td></tr></table></figure><h3 id="可选-运行安全设置向导脚本，修改MySQL用户root的密码，同时可禁止root远程连接，移除test数据库和匿名用户。"><a href="#可选-运行安全设置向导脚本，修改MySQL用户root的密码，同时可禁止root远程连接，移除test数据库和匿名用户。" class="headerlink" title="(可选)运行安全设置向导脚本，修改MySQL用户root的密码，同时可禁止root远程连接，移除test数据库和匿名用户。"></a>(可选)运行安全设置向导脚本，修改MySQL用户root的密码，同时可禁止root远程连接，移除test数据库和匿名用户。</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin&#x2F;mysql_secure_installation</span><br></pre></td></tr></table></figure><h3 id="可选-设置配置文件"><a href="#可选-设置配置文件" class="headerlink" title="(可选)设置配置文件"></a>(可选)设置配置文件</h3><blockquote><p>my.cnf的配置文件的默认读取顺序为:</p></blockquote><table><thead><tr><th>File Name（上面的优先）</th><th>Purpose</th></tr></thead><tbody><tr><td>/etc/my.cnf</td><td>Global options</td></tr><tr><td>/etc/mysql/my.cnf</td><td>Global options</td></tr><tr><td>SYSCONFDIR/my.cnf</td><td>Global options</td></tr><tr><td>$MYSQL_HOME/my.cnf</td><td>Server-specific options</td></tr><tr><td>defaults-extra-file</td><td>The file specified with –defaults-extra-file=path, if any</td></tr><tr><td>~/.my.cnf</td><td>User-specific options</td></tr><tr><td>~/.mylogin.cnf</td><td>Login path options</td></tr></tbody></table><blockquote><p>简单配置如下:</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[client] #客户端配置</span><br><span class="line">port&#x3D;3306 </span><br><span class="line">socket&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;mysql.sock</span><br><span class="line">default-character-set &#x3D; utf8</span><br><span class="line"> </span><br><span class="line">[mysqld]</span><br><span class="line">port&#x3D;3306</span><br><span class="line">bind-address&#x3D;127.0.0.1 #绑定地址</span><br><span class="line">basedir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql</span><br><span class="line">datadir&#x3D;&#x2F;data&#x2F;mysql</span><br><span class="line">socket&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;mysql.sock </span><br><span class="line">user&#x3D;mysql</span><br><span class="line"> </span><br><span class="line">############# default settings ################</span><br><span class="line"># time zone</span><br><span class="line">default-time-zone &#x3D; system</span><br><span class="line">character-set-server &#x3D; utf8</span><br><span class="line">default-storage-engine &#x3D; InnoDB</span><br><span class="line"> </span><br><span class="line">[mysqld_safe]</span><br><span class="line">log-error&#x3D;&#x2F;var&#x2F;log&#x2F;mysqld.log</span><br><span class="line">pid-file&#x3D;&#x2F;data&#x2F;mysqld&#x2F;mysqld.pid</span><br></pre></td></tr></table></figure><h3 id="启动mysql服务"><a href="#启动mysql服务" class="headerlink" title="启动mysql服务"></a>启动mysql服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;init.d&#x2F;mysqld restart</span><br><span class="line">chkconfig --add mysqld</span><br><span class="line">chkconfig mysqld on</span><br></pre></td></tr></table></figure><h2 id="安装php"><a href="#安装php" class="headerlink" title="安装php"></a>安装php</h2><h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar xf php-5.4.35.tar.gz</span><br><span class="line">cd php-5.4.35</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;php  --with-config-file-path&#x3D;&#x2F;usr&#x2F;local&#x2F;php&#x2F;etc  --enable-fpm --with-fpm-user&#x3D;nginx --with-fpm-group&#x3D;nginx --with-mysql&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F; --enable-mbstring --enable-soap --enable-bcmath --enable-zip --enable-calendar --enable-sockets --with-curl&#x3D;&#x2F;usr&#x2F;local&#x2F; --with-gd --with-png-dir&#x3D;&#x2F;usr&#x2F;local&#x2F; --with-freetype-dir&#x3D;&#x2F;usr&#x2F;local&#x2F; --with-jpeg-dir&#x3D;&#x2F;usr&#x2F;local&#x2F; --with-mhash&#x3D;&#x2F;usr&#x2F;local&#x2F; --with-zlib-dir&#x3D;&#x2F;usr&#x2F;local&#x2F; --with-mcrypt&#x3D;&#x2F;usr&#x2F;local&#x2F; --with-libxml-dir&#x3D;&#x2F;usr&#x2F;local --with-iconv&#x3D;&#x2F;usr&#x2F;local&#x2F;iconv</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">#复制php的配置文件php.ini，此文件是php用于初始化解释器环境的配置文件</span><br><span class="line">cp php.ini-development &#x2F;usr&#x2F;local&#x2F;php&#x2F;etc&#x2F;php.ini</span><br></pre></td></tr></table></figure><h3 id="重命名php-fpm的配置文件"><a href="#重命名php-fpm的配置文件" class="headerlink" title="重命名php-fpm的配置文件"></a>重命名php-fpm的配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;local&#x2F;php&#x2F;</span><br><span class="line">mv etc&#x2F;php-fpm.conf.default etc&#x2F;php-fpm.conf</span><br></pre></td></tr></table></figure><h3 id="讲php-fpm脚本添加到init-d目录"><a href="#讲php-fpm脚本添加到init-d目录" class="headerlink" title="讲php-fpm脚本添加到init.d目录"></a>讲php-fpm脚本添加到init.d目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#脚本放置在php的编译目录</span><br><span class="line">cd lnmp_src&#x2F;php-5.5.38</span><br><span class="line">cp sapi&#x2F;fpm&#x2F;init.d.php-fpm &#x2F;etc&#x2F;init.d&#x2F;php-fpm &amp;&amp; chmod +x &#x2F;etc&#x2F;init.d&#x2F;php-fpm</span><br></pre></td></tr></table></figure><h3 id="启动php-fpm"><a href="#启动php-fpm" class="headerlink" title="启动php-fpm"></a>启动php-fpm</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;php&#x2F;sbin&#x2F;php-fpm &amp;</span><br><span class="line">#或者通过其init脚本启动</span><br><span class="line">&#x2F;etc&#x2F;init.d&#x2F;php-fpm restart</span><br></pre></td></tr></table></figure><h2 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h2><h3 id="安装nginx的依赖库"><a href="#安装nginx的依赖库" class="headerlink" title="安装nginx的依赖库"></a>安装nginx的依赖库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install pcre-devel</span><br><span class="line">yum install zlib-devel</span><br></pre></td></tr></table></figure><h3 id="编译安装nginx"><a href="#编译安装nginx" class="headerlink" title="编译安装nginx"></a>编译安装nginx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#下载</span><br><span class="line">wget http:&#x2F;&#x2F;nginx.org&#x2F;download&#x2F;nginx-1.10.1.tar.gz</span><br><span class="line">#解压</span><br><span class="line">tar xf nginx-1.10.1.tar.gz</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx --with-pcre --user&#x3D;nginx --group&#x3D;nginx</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="将nginx的执行路径加入PATH"><a href="#将nginx的执行路径加入PATH" class="headerlink" title="将nginx的执行路径加入PATH"></a>将nginx的执行路径加入PATH</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;profile</span><br><span class="line">PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin</span><br><span class="line">export PATH</span><br></pre></td></tr></table></figure><h3 id="编辑nginx的配置文件-加入解析php相关配置"><a href="#编辑nginx的配置文件-加入解析php相关配置" class="headerlink" title="编辑nginx的配置文件,加入解析php相关配置"></a>编辑nginx的配置文件,加入解析php相关配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name www.pl.com;</span><br><span class="line">    root &#x2F;data&#x2F;www; #定义文档根目录,$document_root变量将调用此值</span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">        index index.php;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">            root             &#x2F;data&#x2F;www;</span><br><span class="line">        fastcgi_pass localhost:9000;</span><br><span class="line">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;     </span><br><span class="line">        include fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LNMP 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
